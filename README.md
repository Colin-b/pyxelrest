# Access REST APIs from Excel using User Defined Functions (UDF)

## Requirements

1. Within Excel, "Trust access to the VBA project object model" should be enabled

    > File > Options > Trust Center > Trust Center Settings > Macro Settings

2. The following python modules must be installed:

    - [pywin32](https://sourceforge.net/projects/pywin32/) is an xlwings dependency

        - For Python 3
            1. It should be [downloaded](http://www.lfd.uci.edu/~gohlke/pythonlibs/#pywin32)
            2. And installed thanks to the following command:

                    pip install pywin32-220.1-cp36-cp36m-win_amd64.whl

		    3. To install pywin32 system files, launch an elevated command prompt

			    	python.exe Scripts\pywin32_postinstall.py -install
			    	
	    - For Python 2
	    
	            pip install pypiwin32
	
    - [jinja2](http://jinja.pocoo.org/) is used to generate a python file containing UDFs
    - [xlwings](https://www.xlwings.org/) is used to interpret generated UDFs python file
    - [requests](http://docs.python-requests.org/en/master/) is used to communicate with services

    They can be downloaded thanks to the following command executed from within src\main\python folder:

        pip install -e . --trusted-host rms.gdfsuez.net --index http://rms.gdfsuez.net:8310/artifactory/api/pypi/python3/simple

3. PathToXlWingsBasFile environment variable must be set to the path of xlwings.bas

    - You can retrieve this path thanks to the following python code:

            import xlwings
            print(xlwings.__path__[0])

4. Update xlwings.bas Settings function:

        PYTHON_WIN = "path\to\your\local\environment\pythonw.exe"
        PYTHONPATH = "path\to\the\pyxelrest\module\folder"
        UDF_MODULES = "pyxelrest"

5. XLWings Excel Add In must be installed. The following command line will copy xlwings.xlam into C:\Users\current_user\AppData\Roaming\Microsoft\Excel\XLSTART\xlwings.xlam

        xlwings addin install

6. Auto Load PyxelRest Excel Add In must be installed

    > VSTO file is generated by AutoLoadPyxelRestAddIn project
